# 测试用例设计方法（核心4种）

本文档定义功能测试的4种核心设计方法，用于指导 Claude 生成专业、全面的测试用例。

---

## 方法选择指南

| 需求特征 | 推荐方法 |
|---------|---------|
| 有明确输入范围/格式要求 | 等价类划分 + 边界值分析 |
| 涉及业务流程/多步骤操作 | 场景法 |
| 历史缺陷多/高风险模块 | 错误推测法 |
| 复杂输入组合 | 等价类 + 场景法 |

---

## 1. 等价类划分法 (Equivalence Partitioning)

### 定义

将输入数据划分为若干等价类，从每个等价类中选取代表性数据作为测试数据。同一等价类中的数据对揭露缺陷的效果是等价的。

### 分类

- **有效等价类**：符合规格说明的合理输入，程序应正确处理
- **无效等价类**：不符合规格说明的非法输入，程序应拒绝并给出提示

### 划分规则

| 输入条件 | 有效等价类 | 无效等价类 |
|---------|-----------|-----------|
| 取值范围 [a, b] | [a, b] 内的值 | <a 的值, >b 的值 |
| 取值集合 {A, B, C} | A, B, C 各取一个 | 非集合内的值 |
| 布尔值 | true, false | 非布尔类型值 |
| 格式要求（如手机号11位） | 符合格式的值 | 不符合格式的值 |
| 必填项 | 非空有效值 | 空值、null、undefined |
| 长度限制 [m, n] | 长度在 [m, n] 内 | 长度 <m 或 >n |

### 用例生成原则

1. 一条用例尽可能覆盖多个**有效**等价类（减少用例数）
2. 每个**无效**等价类必须**单独**一条用例覆盖（确保定位问题）

### 示例：用户年龄输入（18-60岁整数）

| 等价类ID | 等价类 | 类型 | 测试数据 | 预期结果 |
|---------|-------|------|---------|---------|
| EC_01 | [18, 60] | 有效 | 25 | 通过 |
| EC_02 | <18 | 无效 | 10 | 提示年龄不符合要求 |
| EC_03 | >60 | 无效 | 70 | 提示年龄不符合要求 |
| EC_04 | 非数字 | 无效 | "abc" | 提示格式错误 |
| EC_05 | 空值 | 无效 | null | 提示必填 |
| EC_06 | 小数 | 无效 | 25.5 | 提示需为整数 |

### 识别模式

从需求中识别以下关键词来划分等价类：
- 范围词：`范围`、`在...之间`、`不超过`、`至少`、`最多`
- 集合词：`包括`、`仅限`、`只能是`、`可选值`
- 格式词：`格式`、`符合`、`正则`、`必须为`
- 必填词：`必填`、`必须`、`不能为空`

---

## 2. 边界值分析法 (Boundary Value Analysis)

### 定义

对输入/输出的边界进行测试。经验表明，大量缺陷发生在边界附近。

### 边界点定义

- **上点 (On Point)**：边界上的点
- **离点 (Off Point)**：离边界最近的点（边界外侧）
- **内点 (In Point)**：域内任意一点

### 取值规则

| 边界类型 | 测试点 | 示例（范围 1-100） |
|---------|--------|------------------|
| [a, b] 闭区间 | a-1, a, b, b+1 | 0, 1, 100, 101 |
| (a, b) 开区间 | a, a+1, b-1, b | 1, 2, 99, 100 |
| [a, b) 左闭右开 | a-1, a, b-1, b | 0, 1, 99, 100 |
| (a, b] 左开右闭 | a, a+1, b, b+1 | 1, 2, 100, 101 |
| 最大长度 N | N-1, N, N+1 | - |
| 最小长度 M | M-1, M, M+1 | - |

### 与等价类结合使用

标准流程：
1. 先用等价类划分确定输入域
2. 对每个等价类的边界进行边界值分析
3. 边界值用例独立于等价类用例

### 示例：密码长度 6-20 位

| 测试点 | 类型 | 值 | 预期结果 |
|-------|------|-----|---------|
| 下边界-1 | 离点 | 5位 | 失败：密码太短 |
| 下边界 | 上点 | 6位 | 成功 |
| 上边界 | 上点 | 20位 | 成功 |
| 上边界+1 | 离点 | 21位 | 失败：密码太长 |
| 内点 | 内点 | 12位 | 成功 |

### 识别模式

从需求中识别以下关键词提取边界：
- 数值边界：`最小`、`最大`、`不超过`、`至少`、`≤`、`≥`、`<`、`>`
- 长度边界：`长度`、`字符数`、`位数`、`最短`、`最长`
- 数量边界：`个数`、`条数`、`数量限制`

---

## 3. 场景法 (Scenario Testing)

### 定义

通过模拟用户实际使用场景，覆盖业务流程中的各种路径。适用于事件触发型业务流程。

### 流程类型

| 流程类型 | 定义 | 优先级 |
|---------|------|--------|
| **基本流** | 最常见的正常操作路径（主成功场景） | P0 |
| **备选流** | 可接受的替代路径，最终仍能完成目标 | P1 |
| **异常流** | 错误处理路径，触发错误提示或回退 | P2 |

### 场景识别方法

1. **从需求中提取**：
   - 用户故事格式：`作为...我想要...以便于...`
   - 前置条件、后置条件
   - 流程步骤描述

2. **识别条件分支**：
   - `当...时`、`如果...则`、`否则`
   - `或者`、`也可以`
   - `失败时`、`超时后`、`错误情况`

3. **流程图梳理**：
   - 绘制流程图标记所有分支
   - 每条路径生成一个场景

### 用例生成规则

| 场景类型 | 用例覆盖要求 |
|---------|-------------|
| 基本流 | 至少1条用例完整覆盖整个流程 |
| 备选流 | 基本流 + 该备选流分支 |
| 异常流 | 触发点 + 异常处理验证 |

### 示例：用户登录场景

```
基本流：
  1. 输入账号
  2. 输入密码
  3. 点击登录
  4. 验证成功，进入首页

备选流1（记住登录）：
  基本流步骤 2 后 → 勾选"记住我" → 继续步骤 3

备选流2（验证码登录）：
  1. 选择验证码登录
  2. 输入手机号
  3. 获取验证码
  4. 输入验证码
  5. 点击登录
  6. 验证成功，进入首页

异常流1（密码错误）：
  基本流步骤 3 → 密码错误 → 提示"账号或密码错误"

异常流2（账号不存在）：
  基本流步骤 3 → 账号不存在 → 提示"账号不存在，请注册"

异常流3（网络超时）：
  基本流步骤 3 → 网络超时 → 提示"网络异常，请重试"

异常流4（账号锁定）：
  连续5次密码错误 → 账号锁定15分钟
```

### 用例矩阵

| 场景ID | 场景名称 | 路径 | 优先级 |
|--------|---------|------|--------|
| SC_01 | 正常登录 | 基本流 | P0 |
| SC_02 | 记住登录状态 | 基本流 + 备选流1 | P1 |
| SC_03 | 验证码登录 | 备选流2 | P1 |
| SC_04 | 密码错误提示 | 基本流 → 异常流1 | P1 |
| SC_05 | 账号不存在 | 基本流 → 异常流2 | P2 |
| SC_06 | 网络异常处理 | 基本流 → 异常流3 | P2 |
| SC_07 | 账号锁定机制 | 异常流4 | P1 |

---

## 4. 错误推测法 (Error Guessing)

### 定义

基于测试经验和直觉，推测程序可能存在的缺陷位置，有针对性地设计测试用例。这是对其他方法的补充。

### 常见错误模式

#### 输入相关错误

| 错误类型 | 测试数据示例 |
|---------|-------------|
| 空值 | `null`、`undefined`、`""`、空格 |
| 特殊字符 | `' " < > & \ / # @ ! $ % ^ * ( )` |
| 极端值 | `0`、`-1`、`MAX_INT`、超长字符串（1000+字符） |
| 格式错误 | 错误日期格式、无效邮箱、短于11位手机号 |
| 注入攻击 | `' OR 1=1 --`（SQL）、`<script>alert(1)</script>`（XSS） |
| Unicode | 中文、日文、emoji、特殊Unicode字符 |

#### 操作相关错误

| 错误类型 | 测试场景 |
|---------|---------|
| 重复提交 | 快速双击提交按钮 |
| 并发操作 | 多窗口/多Tab同时操作同一数据 |
| 操作中断 | 提交过程中刷新页面、关闭浏览器 |
| 顺序颠倒 | 跳过必要步骤直接访问后续页面 |
| 回退操作 | 提交后点击浏览器返回按钮 |

#### 数据相关错误

| 错误类型 | 测试场景 |
|---------|---------|
| 边界数据 | 第一条记录、最后一条记录 |
| 重复数据 | 相同内容重复提交 |
| 关联数据 | 删除被其他数据引用的记录 |
| 历史数据 | 过期数据的显示与处理 |
| 空列表 | 无数据时的页面展示 |

#### 环境相关错误

| 错误类型 | 测试场景 |
|---------|---------|
| 浏览器兼容 | Chrome、Firefox、Safari、Edge |
| 屏幕适配 | 移动端、平板、PC各分辨率 |
| 弱网环境 | 2G/3G网络、高延迟、丢包 |
| 时区差异 | 不同时区的时间显示 |

### 示例：搜索功能错误推测

| 错误类型 | 测试场景 | 预期结果 |
|---------|---------|---------|
| 空值 | 搜索框为空点击搜索 | 提示输入搜索词或显示全部 |
| 特殊字符 | 搜索 `%_*?` 通配符 | 正确转义，不报错 |
| 超长输入 | 输入1000个字符 | 限制输入或正确处理 |
| SQL注入 | 输入 `' OR '1'='1` | 无注入风险，正常搜索 |
| XSS | 输入 `<script>alert(1)</script>` | 正确转义，不执行脚本 |
| 无结果 | 搜索不存在的关键词 | 显示"无结果"友好提示 |
| 大结果集 | 搜索热门词 | 分页显示，无性能问题 |
| 空格处理 | 搜索词前后有空格 | 自动去除空格 |

---

## 方法组合策略

### 标准用例设计流程

```
1. 等价类划分 → 识别所有输入的有效/无效等价类
       ↓
2. 边界值分析 → 对每个等价类的边界进行测试
       ↓
3. 场景法     → 覆盖主要业务流程（基本流+备选流+异常流）
       ↓
4. 错误推测   → 补充经验性测试用例
```

### 覆盖优先级映射

| 优先级 | 覆盖内容 |
|--------|---------|
| **P0** | 基本流用例 + 核心有效等价类 |
| **P1** | 备选流用例 + 边界值 + 主要无效等价类 |
| **P2** | 异常流用例 + 次要无效等价类 + 常见错误推测 |
| **P3** | 边缘错误推测 + 环境兼容性 |

### 设计方法标记

生成用例时，在「设计方法」列标记使用的方法：
- `EP` - 等价类划分 (Equivalence Partitioning)
- `BVA` - 边界值分析 (Boundary Value Analysis)
- `ST` - 场景法 (Scenario Testing)
- `EG` - 错误推测 (Error Guessing)
- `EP+BVA` - 组合使用
